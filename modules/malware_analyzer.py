from utils.TypeClasses.DNS import DNS

alphabet = []

def calc_math_index( string : str ) -> float:
    string_len = len(string)
    k = 0
    for ch in alphabet:
        Fi = string.count(ch)
        k += ( Fi * (Fi -1) ) / ( string_len * (string_len - 1) ) 
    return k

def is_hex(string : str)->bool:
    try:
        return int(string , 16)
    except:
        return False


def dns_tunel_check( dns_data : list[DNS] ):
    response = {}
    for dns in dns_data:
        splitted_query_name : list[str] = dns.query_name.split('.')
        if len(splitted_query_name) > 2:
            for spq_n in splitted_query_name:
                if is_hex(spq_n):
                    response[dns.query_name] = True
    return response

            

def malware_analyzer(  ):
    pass